{% extends 'layouts/app.jinja2' %}
{% import 'macros/detail.jinja2' as detail %}
{% import 'macros/start.jinja2' as start %}
{% import 'macros/topbar.jinja2' as topbar %}

{% block title %}Plataforma Perseo{% endblock %}

{% block topbar_actions %}
    {{ topbar.page('Plataforma Perseo') }}
{% endblock %}

{% block content %}
    {# Detalle de la ultima quincena #}
    {% call detail.card(title='Última quincena') %}
        {% if quincena %}
            {{ detail.label_value_big('Quincena', quincena.clave, url_for('quincenas.detail', quincena_id=quincena.id)) }}
            {{ detail.label_value('Estado', quincena.estado) }}
            {{ detail.label_value('Creado', moment(quincena.creado, local=True).format('DD MMM YYYY')) }}
        {% else %}
            <p class="lead text-center">No hay una última quincena</p>
        {% endif %}
    {% endcall %}
    {# Descargar los productos de la quincena #}
    <div class="row mb-2">
        <div class="col-md-3">
            {% call detail.card(title='<span class="iconify" data-icon="mdi:credit-card"></span> Nóminas') %}
                {% if quincena_producto_nominas %}
                    <ul>
                        <li>{{ moment(quincena_producto_nominas.creado).format('DD MMM YYYY HH:mm') }}</li>
                    </ul>
                    {{ detail.button_md('Descargar XLSX', quincena_producto_nominas.url, 'mdi:download', '_blank') }}
                {% else %}
                    <p class="lead text-center">No hay archivo</p>
                {% endif %}
            {% endcall %}
        </div>
        <div class="col-md-3">
            {% call detail.card(title='<span class="iconify" data-icon="mdi:cart"></span> Monederos') %}
                {% if quincena_producto_monederos %}
                    <ul>
                        <li>{{ moment(quincena_producto_monederos.creado).format('DD MMM YYYY HH:mm') }}</li>
                    </ul>
                    {{ detail.button_md('Descargar XLSX', quincena_producto_monederos.url, 'mdi:download', '_blank') }}
                {% else %}
                    <p class="lead text-center">No hay archivo</p>
                {% endif %}
            {% endcall %}
        </div>
        <div class="col-md-3">
            {% call detail.card(title='Pensionados') %}
                {% if quincena_producto_pensionados %}
                    <ul>
                        <li>{{ moment(quincena_producto_pensionados.creado).format('DD MMM YYYY HH:mm') }}</li>
                    </ul>
                    {{ detail.button_md('Descargar XLSX', quincena_producto_pensionados.url, 'mdi:download', '_blank') }}
                {% else %}
                    <p class="lead text-center">No hay archivo</p>
                {% endif %}
            {% endcall %}
        </div>
    </div>
    <div class="row mb-2">
        <div class="col-md-3">
            {% call detail.card(title='Dispersiones Pensionados') %}
                {% if quincena_producto_dispersiones_pensionados %}
                    <ul>
                        <li>{{ moment(quincena_producto_dispersiones_pensionados.creado).format('DD MMM YYYY HH:mm') }}</li>
                    </ul>
                    {{ detail.button_md('Descargar XLSX', quincena_producto_dispersiones_pensionados.url, 'mdi:download', '_blank') }}
                {% else %}
                    <p class="lead text-center">No hay archivo</p>
                {% endif %}
            {% endcall %}
        </div>
    </div>
{% endblock %}

{% block custom_javascript %}
    <!-- Moment.js -->
    {{ detail.moment_js(moment) }}
{% endblock %}
